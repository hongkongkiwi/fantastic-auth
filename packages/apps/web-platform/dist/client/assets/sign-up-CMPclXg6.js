import{j as t,r as c,bz as S,bt as U,bF as P,by as T,bB as I,ab as _,D as A,W as B}from"./vendor-DTXcECKj.js";import{g as E,f as L,B as j,j as F,l as q,F as H,L as D}from"./main-D_qbY1gz.js";import{I as h}from"./Input-CvXUl1_l.js";import{C as y,d as w,a as O,b as R,c as z}from"./Card-ovhP7agJ.js";import{H as V,u as W,a as M,b as G}from"./HostedLayout-DYymfZHG.js";import{S as $}from"./SocialLoginButtons-DGrqqYSa.js";import{u as J,m as Y}from"./vendor-motion-DirI8ZVJ.js";import"./vendor-sonner-CauEFWQC.js";import"./vendor-sentry-DWdptYQI.js";function ne(){return t.jsx(V,{searchParams:new URLSearchParams(window.location.search),children:t.jsx(Z,{})})}function Z(){const g=E(),{config:r,tenantId:a,redirectUrl:d}=W(),x=J(),[u,C]=c.useState(!1),[i,p]=c.useState(!1),[f,m]=c.useState(null),[b,v]=c.useState(null),[N,k]=c.useState(!1),o=L({defaultValues:{name:"",email:"",password:"",agreeToTerms:!1},onSubmit:async({value:e})=>{if(a){p(!0),m(null);try{const s=await M({data:{name:e.name,email:e.email,password:e.password,tenantId:a,redirectUrl:d||void 0}});r?.requireEmailVerification?(sessionStorage.removeItem("hosted_session_token"),k(!0)):(s.sessionToken&&sessionStorage.setItem("hosted_session_token",s.sessionToken),window.location.href=s.redirectUrl)}catch(s){m(s instanceof Error?s.message:"Sign up failed")}finally{p(!1)}}}}),l=async e=>{if(a){v(e),m(null);try{const s=await G({data:{provider:e,tenantId:a,redirectUrl:d||void 0}});sessionStorage.setItem("hosted_oauth_state",s.state),window.location.href=s.authUrl}catch(s){m(s instanceof Error?s.message:"OAuth failed"),v(null)}}};if(!r||!a)return null;if(!r.allowSignUp)return g({to:"/hosted/sign-in",search:{tenant_id:a,redirect_url:d||void 0}}),null;const n=r.oauthProviders.filter(e=>["google","github","apple","slack","discord"].includes(e));return N?t.jsx(y,{className:"shadow-elevated",children:t.jsx(w,{className:"pt-6",children:t.jsxs("div",{className:"text-center space-y-4 py-8",children:[t.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto",children:t.jsx(S,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold",children:"Verify your email"}),t.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["We've sent a verification link to ",t.jsx("strong",{children:o.getFieldValue("email")})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Click the link in your email to complete your registration."})]}),t.jsx(j,{variant:"outline",fullWidth:!0,onClick:()=>g({to:"/hosted/sign-in",search:{tenant_id:a}}),children:"Back to Sign In"})]})})}):t.jsxs(y,{className:"shadow-elevated",children:[t.jsxs(O,{className:"space-y-1",children:[t.jsx(R,{className:"text-2xl text-center",children:r.signUpTitle||`Create your ${r.companyName} account`}),t.jsx(z,{className:"text-center",children:"Enter your details to get started"})]}),t.jsxs(w,{className:"space-y-4",children:[f&&t.jsxs(F,{variant:"destructive",children:[t.jsx(U,{className:"h-4 w-4"}),t.jsx(q,{children:f})]}),n.length>0&&t.jsx(Y.div,{initial:x?!1:{opacity:0},animate:{opacity:1},transition:x?{duration:0}:{delay:.1},children:t.jsx($,{onGoogleClick:n.includes("google")?()=>l("google"):void 0,onGitHubClick:n.includes("github")?()=>l("github"):void 0,onAppleClick:n.includes("apple")?()=>l("apple"):void 0,onSlackClick:n.includes("slack")?()=>l("slack"):void 0,onDiscordClick:n.includes("discord")?()=>l("discord"):void 0,isLoading:!!b})}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),o.handleSubmit()},className:"space-y-4",children:[t.jsx(o.Field,{name:"name",validators:{onChange:({value:e})=>{if(!e.trim())return"Name is required";if(e.trim().length<2)return"Name must be at least 2 characters"}},children:e=>t.jsx(h,{label:"Full Name",type:"text",placeholder:"John Doe",value:e.state.value,onChange:s=>e.handleChange(s.target.value),onBlur:e.handleBlur,error:e.state.meta.isTouched?e.state.meta.errors[0]:void 0,leftIcon:t.jsx(P,{className:"h-4 w-4 text-muted-foreground"}),autoComplete:"name",required:!0,disabled:i})}),t.jsx(o.Field,{name:"email",validators:{onChange:({value:e})=>{if(!e.trim())return"Email is required";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return"Please enter a valid email"}},children:e=>t.jsx(h,{label:"Email",type:"email",placeholder:"you@example.com",value:e.state.value,onChange:s=>e.handleChange(s.target.value),onBlur:e.handleBlur,error:e.state.meta.isTouched?e.state.meta.errors[0]:void 0,leftIcon:t.jsx(T,{className:"h-4 w-4 text-muted-foreground"}),autoComplete:"email",autoCapitalize:"none",spellCheck:!1,required:!0,disabled:i})}),t.jsx(o.Field,{name:"password",validators:{onChange:({value:e})=>{if(!e)return"Password is required";if(e.length<8)return"Password must be at least 8 characters";if(!/[A-Z]/.test(e))return"Password must contain an uppercase letter";if(!/[a-z]/.test(e))return"Password must contain a lowercase letter";if(!/[0-9]/.test(e))return"Password must contain a number"}},children:e=>t.jsx(h,{label:"Password",type:u?"text":"password",placeholder:"••••••••",value:e.state.value,onChange:s=>e.handleChange(s.target.value),onBlur:e.handleBlur,error:e.state.meta.isTouched?e.state.meta.errors[0]:void 0,leftIcon:t.jsx(A,{className:"h-4 w-4 text-muted-foreground"}),autoComplete:"new-password",rightIcon:t.jsx("button",{type:"button",onClick:()=>C(!u),className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":u?"Hide password":"Show password",children:u?t.jsx(I,{className:"h-4 w-4"}):t.jsx(_,{className:"h-4 w-4"})}),required:!0,disabled:i})}),(r.termsUrl||r.privacyUrl)&&t.jsx(o.Field,{name:"agreeToTerms",validators:{onChange:({value:e})=>{if(!e)return"You must agree to continue"}},children:e=>t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(H,{id:"agreeToTerms",checked:e.state.value,onCheckedChange:s=>e.handleChange(s),disabled:i}),t.jsxs("label",{htmlFor:"agreeToTerms",className:"text-sm text-muted-foreground leading-relaxed cursor-pointer",children:["I agree to the"," ",r.termsUrl?t.jsx("a",{href:r.termsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",onClick:s=>s.stopPropagation(),children:"Terms of Service"}):"Terms of Service",r.termsUrl&&r.privacyUrl&&" and ",r.privacyUrl?t.jsx("a",{href:r.privacyUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",onClick:s=>s.stopPropagation(),children:"Privacy Policy"}):r.termsUrl?"Privacy Policy":null]})]}),e.state.meta.isTouched&&e.state.meta.errors[0]&&t.jsx("p",{className:"text-sm text-destructive",children:e.state.meta.errors[0]})]})}),t.jsx(j,{type:"submit",fullWidth:!0,size:"lg",isLoading:i,rightIcon:t.jsx(B,{className:"h-4 w-4"}),children:"Create Account"})]}),t.jsxs("div",{className:"text-center text-sm pt-4 border-t",children:[t.jsxs("span",{className:"text-muted-foreground",children:["Already have an account?"," "]}),t.jsx(D,{to:"/hosted/sign-in",search:{tenant_id:a,redirect_url:d||void 0},className:"text-primary hover:underline",children:"Sign in"})]})]})]})}export{ne as component};

import{r as n,j as e,bH as F,a7 as y,bD as T}from"./vendor-DTXcECKj.js";import{a as M,P as B,B as r,L,t as U,d as z,p as E}from"./main-D_qbY1gz.js";import{C as K}from"./Card-ovhP7agJ.js";import{I as g}from"./Input-CvXUl1_l.js";import{D as O}from"./DataTable-B1vFbS0r.js";import{D as A,a as R,b as H,c as j}from"./DropdownMenu-DLlbKs3-.js";import{m as V}from"./internal-api-CvC1OOUg.js";import"./vendor-sonner-CauEFWQC.js";import"./vendor-motion-DirI8ZVJ.js";import"./vendor-sentry-DWdptYQI.js";import"./logger-BML-1mmb.js";function ae(){const[b,w]=n.useState([]),[c,h]=n.useState(!0),[l,i]=n.useState(1),[d,P]=n.useState(10),[u,N]=n.useState("all"),[x,C]=n.useState(""),[m,I]=n.useState(""),[p,v]=n.useState(""),[o,S]=n.useState({page:1,perPage:10,total:0,totalPages:1}),f=M(V),D=n.useMemo(()=>[10,20,50,100],[]);n.useEffect(()=>{(async()=>{h(!0);try{const s=await f({data:{page:l,perPage:d,tenantId:x.trim()?x.trim():void 0,status:u==="all"?void 0:u,createdFrom:m||void 0,createdTo:p||void 0}});w(s.invoices||[]),S({page:s.pagination?.page??l,perPage:s.pagination?.perPage??d,total:s.pagination?.total??s.invoices?.length??0,totalPages:s.pagination?.totalPages??Math.max(1,Math.ceil((s.invoices?.length??0)/d))})}catch{U.error("Failed to load invoices")}finally{h(!1)}})()},[l,d,u,x,m,p,f]);const k=[{accessorKey:"id",header:"Invoice",cell:({row:a})=>e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.original.id}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.original.tenantId})]})},{accessorKey:"status",header:"Status",cell:({getValue:a})=>{const t=a(),s=t==="paid"?"success":t==="open"||t==="draft"?"warning":"destructive";return e.jsx(z,{variant:s,children:t})}},{accessorKey:"amount",header:"Amount",cell:({row:a})=>E(a.original.amount||0)},{accessorKey:"createdAt",header:"Date",cell:({getValue:a})=>new Date(a()).toLocaleDateString()},{id:"actions",header:"",cell:({row:a})=>e.jsxs(A,{children:[e.jsx(R,{asChild:!0,children:e.jsx(r,{variant:"ghost",size:"icon-sm","aria-label":"Invoice actions",children:e.jsx(F,{className:"h-4 w-4"})})}),e.jsxs(H,{align:"end",children:[e.jsxs(j,{onClick:()=>{const t=a.original.pdfUrl;t&&window.open(t,"_blank","noopener,noreferrer")},children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"View Invoice"]}),e.jsxs(j,{onClick:()=>{const t=a.original.pdfUrl;t&&window.open(t,"_blank","noopener,noreferrer")},children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Download PDF"]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(B,{title:"Invoices",description:"Review invoices across tenants",breadcrumbs:[{label:"Billing",href:"/billing"},{label:"Invoices"}],actions:e.jsx(r,{variant:"outline",asChild:!0,children:e.jsx(L,{to:"/billing",children:"Back to Billing"})})}),e.jsxs(K,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-end gap-4 border-b px-4 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Status"}),e.jsxs("select",{className:"h-9 rounded-md border border-input bg-background px-2 text-sm",value:u,onChange:a=>{N(a.target.value),i(1)},children:[e.jsx("option",{value:"all",children:"All statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"uncollectible",children:"Uncollectible"}),e.jsx("option",{value:"void",children:"Void"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Tenant ID"}),e.jsx(g,{placeholder:"Tenant UUID",value:x,onChange:a=>{C(a.target.value),i(1)}})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Created From"}),e.jsx(g,{type:"date",value:m,onChange:a=>{const t=a.target.value;I(t?new Date(t).toISOString():""),i(1)}})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Created To"}),e.jsx(g,{type:"date",value:p?p.slice(0,10):"",onChange:a=>{const t=a.target.value;if(t){const s=new Date(`${t}T23:59:59.999Z`);v(s.toISOString())}else v("");i(1)}})]})]}),e.jsx(O,{columns:k,data:b,isLoading:c,searchable:!0,searchPlaceholder:"Search invoices…",pagination:!1,exportable:!0,exportFileName:"invoices"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 border-t px-4 py-3 text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Showing page ",o.page," of ",o.totalPages," · ",o.total," total"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Rows"}),e.jsx("select",{className:"h-8 rounded-md border border-input bg-background px-2 text-sm",value:d,onChange:a=>{const t=Number(a.target.value);P(t),i(1)},children:D.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>i(1),disabled:l<=1||c,children:"First"}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>i(a=>Math.max(1,a-1)),disabled:l<=1||c,children:"Prev"}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>i(a=>Math.min(o.totalPages,a+1)),disabled:l>=o.totalPages||c,children:"Next"}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>i(o.totalPages),disabled:l>=o.totalPages||c,children:"Last"})]})]})]})]})]})}export{ae as component};

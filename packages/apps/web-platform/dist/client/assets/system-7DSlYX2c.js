import{r as y,j as e,u as v,bq as N,m as b,br as F,bs as w,bt as P}from"./vendor-DTXcECKj.js";import{u as C,a as d,b as S,c as M,P as k,B,d as t,t as m}from"./main-D_qbY1gz.js";import{C as i}from"./Card-ovhP7agJ.js";import{T as R,a as T,b as n,c as l}from"./Tabs-B49fZEnE.js";import{S as o}from"./Switch-C_TaIxIx.js";import{u as q,l as A}from"./internal-api-CvC1OOUg.js";import{u as E,m as I}from"./vendor-motion-DirI8ZVJ.js";import"./vendor-sonner-CauEFWQC.js";import"./vendor-sentry-DWdptYQI.js";import"./logger-BML-1mmb.js";const H=[{id:"ff-1",name:"New Billing Engine",key:"billing_v2",description:"Enable the new billing pipeline for eligible tenants",enabled:!0,rolloutPercentage:25},{id:"ff-2",name:"Realtime Audit",key:"audit_stream",description:"Stream audit events to configured destinations",enabled:!1,rolloutPercentage:0}],L=[{service:"API",status:"healthy",latency:"120ms"},{service:"Auth",status:"healthy",latency:"95ms"},{service:"Billing",status:"degraded",latency:"420ms"},{service:"Webhooks",status:"healthy",latency:"160ms"}];function U(){const r=E(),u=C(),x=d(A),h=d(q),{data:a,isLoading:g}=S({queryKey:["feature-flags"],queryFn:()=>x({data:{}})}),j=y.useMemo(()=>!a||a.length===0?H:a,[a]),c=M({mutationFn:async s=>h({data:{flagId:s.flagId,enabled:s.enabled,rolloutPercentage:s.rolloutPercentage}}),onSuccess:()=>{u.invalidateQueries({queryKey:["feature-flags"]}),m.success("Feature flag updated")},onError:()=>m.error("Failed to update feature flag")}),f=s=>{s.id&&c.mutate({flagId:s.id,enabled:!s.enabled})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(k,{title:"System",description:"Health, feature flags, and maintenance controls",breadcrumbs:[{label:"System"}],actions:e.jsxs(B,{variant:"outline",children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Run Diagnostics"]})}),e.jsxs(R,{defaultValue:"health",className:"space-y-6",children:[e.jsxs(T,{className:"flex flex-wrap",children:[e.jsx(n,{value:"health",children:"Health"}),e.jsx(n,{value:"flags",children:"Feature Flags"}),e.jsx(n,{value:"maintenance",children:"Maintenance"})]}),e.jsx(l,{value:"health",className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:L.map((s,p)=>e.jsx(I.div,{initial:r?!1:{opacity:0,y:10},animate:{opacity:1,y:0},transition:r?{duration:0}:{delay:p*.05},children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.service}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Latency ",s.latency]})]})]}),e.jsx(t,{variant:s.status==="healthy"?"success":"warning",children:s.status})]})})},s.service))})}),e.jsx(l,{value:"flags",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:j.map(s=>e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsx(t,{variant:"secondary",className:"font-mono text-xs",children:s.key})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:s.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Rollout: ",s.rolloutPercentage??0,"%"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(o,{checked:!!s.enabled,onCheckedChange:()=>f(s),disabled:g||c.isPending})})]})},s.id))})}),e.jsxs(l,{value:"maintenance",className:"space-y-4",children:[e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Maintenance Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pause logins and API traffic"})]}),e.jsx(o,{})]})}),e.jsxs(i,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Background Jobs"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Queue processing and webhooks"})]})]}),e.jsxs(t,{variant:"success",className:"flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),"Healthy"]})]}),e.jsxs("div",{className:"mt-4 flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-5 w-5 text-amber-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Email Delivery"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Retry queue delayed"})]})]}),e.jsx(t,{variant:"warning",children:"Degraded"})]})]})]})]})]})}export{U as component};

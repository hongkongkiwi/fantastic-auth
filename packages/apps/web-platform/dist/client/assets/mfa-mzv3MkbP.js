import{j as e,r as t,D as L,bt as M,m as j,by as N,bX as y,W as k,bO as P}from"./vendor-DTXcECKj.js";import{g as H,j as I,l as D,B as F,L as _}from"./main-D_qbY1gz.js";import{I as U}from"./Input-CvXUl1_l.js";import{C as V,a as B,b as O,c as W,d as q}from"./Card-ovhP7agJ.js";import{T as z,a as K,b as m,c as X}from"./Tabs-B49fZEnE.js";import{H as $,u as G}from"./HostedLayout-DYymfZHG.js";import{u as J,m as Q}from"./vendor-motion-DirI8ZVJ.js";import"./vendor-sonner-CauEFWQC.js";import"./vendor-sentry-DWdptYQI.js";const r={totp:{icon:j,title:"Authenticator App",description:"Enter the 6-digit code from your authenticator app",showResend:!1},email:{icon:N,title:"Email Code",description:"Enter the 6-digit code sent to your email",showResend:!0},sms:{icon:y,title:"SMS Code",description:"Enter the 6-digit code sent to your phone",showResend:!0}};function le(){return e.jsx($,{searchParams:new URLSearchParams(window.location.search),children:e.jsx(Y,{})})}function Y(){const b=H(),{config:w,tenantId:c,redirectUrl:u}=G(),v=J(),[l,h]=t.useState(!1),[x,a]=t.useState(null),[o,C]=t.useState(""),[R,S]=t.useState("totp"),[n,p]=t.useState(30),[i,f]=t.useState(!1),T=new URLSearchParams(window.location.search).get("mfa_token");if(t.useEffect(()=>{if(n>0&&!i){const s=setTimeout(()=>p(n-1),1e3);return()=>clearTimeout(s)}else n===0&&f(!0)},[n,i]),!w||!c)return null;if(!T)return b({to:"/hosted/sign-in",search:{tenant_id:c,redirect_url:u||void 0}}),null;const g=async()=>{if(o.length!==6){a("Please enter a 6-digit code");return}a("Hosted MFA challenge continuation is not available in this build. Return to sign-in and enter MFA code there.")},A=async()=>{if(i){h(!0),a(null);try{a("Code resend is not available in this build. Return to sign-in to request a new challenge."),p(30),f(!1)}catch(s){a(s instanceof Error?s.message:"Failed to resend code")}finally{h(!1)}}};return e.jsxs(V,{className:"shadow-elevated",children:[e.jsxs(B,{className:"space-y-1",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(L,{className:"h-6 w-6 text-primary"})}),e.jsx(O,{className:"text-2xl text-center",children:"Two-Factor Authentication"}),e.jsx(W,{className:"text-center",children:"Choose a verification method to continue"})]}),e.jsxs(q,{className:"space-y-4",children:[x&&e.jsxs(I,{variant:"destructive",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx(D,{children:x})]}),e.jsxs(z,{value:R,onValueChange:s=>S(s),children:[e.jsxs(K,{className:"grid w-full grid-cols-3",children:[e.jsxs(m,{value:"totp",className:"gap-2",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"App"})]}),e.jsxs(m,{value:"email",className:"gap-2",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Email"})]}),e.jsxs(m,{value:"sms",className:"gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"SMS"})]})]}),Object.keys(r).map(s=>{const E=r[s].icon;return e.jsx(X,{value:s,className:"mt-4 space-y-4",children:e.jsxs(Q.div,{initial:v?!1:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(E,{className:"h-6 w-6 text-primary"})}),e.jsx("h3",{className:"font-semibold",children:r[s].title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r[s].description})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(U,{type:"text",placeholder:"000000",value:o,onChange:d=>C(d.target.value.replace(/\D/g,"").slice(0,6)),className:"text-center text-2xl tracking-widest font-mono",maxLength:6,inputMode:"numeric",autoComplete:"one-time-code",autoFocus:!0,disabled:l,onKeyDown:d=>{d.key==="Enter"&&o.length===6&&g()}})}),e.jsx(F,{fullWidth:!0,size:"lg",isLoading:l,disabled:o.length!==6,onClick:g,rightIcon:e.jsx(k,{className:"h-4 w-4"}),children:"Verify"}),r[s].showResend&&e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:A,disabled:!i||l,className:"text-sm text-primary hover:underline disabled:text-muted-foreground disabled:no-underline disabled:cursor-not-allowed",children:i?"Resend code":`Resend code in ${n}s`})})]})},s)})]}),e.jsx("div",{className:"text-center pt-4 border-t",children:e.jsxs(_,{to:"/hosted/sign-in",search:{tenant_id:c,redirect_url:u||void 0},className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(P,{className:"h-4 w-4"}),"Use a different sign-in method"]})})]})]})}export{le as component};

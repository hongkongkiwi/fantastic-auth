import{j as e,r as i,B as m,bt as S,N as w,cl as k,a5 as O,W as L,U}from"./vendor-DTXcECKj.js";import{g as A,j as E,l as I,B as y}from"./main-D_qbY1gz.js";import{C as P,a as H,b as R,c as B,d as T}from"./Card-ovhP7agJ.js";import{H as _,u as D,g as F,i as M}from"./HostedLayout-DYymfZHG.js";import{u as W,m as b,A as Y}from"./vendor-motion-DirI8ZVJ.js";import"./vendor-sonner-CauEFWQC.js";import"./vendor-sentry-DWdptYQI.js";function Z(){return e.jsx(_,{searchParams:new URLSearchParams(window.location.search),children:e.jsx($,{})})}function $(){const v=A(),{config:C,tenantId:r,redirectUrl:x,organizationId:h}=D(),c=W(),[d,u]=i.useState(!0),[p,n]=i.useState(null),[o,z]=i.useState([]),[l,g]=i.useState(null),f=()=>sessionStorage.getItem("hosted_session_token")||"";if(i.useEffect(()=>{if(!r)return;(async()=>{const a=f();if(!a){n("You must be signed in to view organizations"),u(!1);return}try{const t=await F({data:{tenantId:r,sessionToken:a}});z(t.organizations)}catch(t){n(t instanceof Error?t.message:"Failed to load organizations")}finally{u(!1)}})()},[r]),!C||!r)return null;const j=async s=>{const a=f();if(!a){n("Session expired. Please sign in again.");return}g(s),n(null);try{const t=await M({data:{organizationId:s,tenantId:r,sessionToken:a}});window.location.href=x||t.redirectUrl}catch(t){n(t instanceof Error?t.message:"Failed to switch organization"),g(null)}},N=()=>{v({to:"/hosted/organization/create",search:{tenant_id:r,redirect_url:x||void 0}})};return e.jsxs(P,{className:"shadow-elevated",children:[e.jsxs(H,{className:"space-y-1",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(m,{className:"h-6 w-6 text-primary"})}),e.jsx(R,{className:"text-2xl text-center",children:"Switch Organization"}),e.jsx(B,{className:"text-center",children:"Select an organization to continue"})]}),e.jsxs(T,{className:"space-y-4",children:[p&&e.jsxs(E,{variant:"destructive",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx(I,{children:p})]}),d?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading organizations..."})]}):o.length===0?e.jsxs(b.div,{initial:c?!1:{opacity:0},animate:{opacity:1},className:"text-center py-8 space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto",children:e.jsx(m,{className:"h-8 w-8 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"You don't have any organizations yet."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create one to get started."})]}),e.jsxs(y,{onClick:N,className:"gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Create Organization"]})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(Y,{mode:"popLayout",children:o.map((s,a)=>e.jsx(b.div,{initial:c?!1:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},transition:{delay:c?0:a*.05},children:e.jsxs("button",{type:"button",onClick:()=>j(s.id),disabled:l===s.id,className:`w-full flex items-center gap-4 p-4 rounded-lg border transition-all text-left ${h===s.id?"border-primary bg-primary/5":"border-border hover:border-primary/50 hover:bg-muted/50"}`,children:[e.jsx("div",{className:"flex-shrink-0",children:s.logoUrl?e.jsx("img",{src:s.logoUrl,alt:s.name,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx(m,{className:"h-6 w-6 text-primary"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold truncate",children:s.name}),s.role==="owner"&&e.jsx(k,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["/",s.slug]})]}),e.jsx("div",{className:"flex-shrink-0",children:l===s.id?e.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}):h===s.id?e.jsxs("div",{className:"flex items-center gap-1 text-primary text-sm",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Current"})]}):e.jsx(L,{className:"h-5 w-5 text-muted-foreground"})})]})},s.id))})}),!d&&o.length>0&&e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(y,{variant:"outline",fullWidth:!0,onClick:N,className:"gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Create New Organization"]})}),!d&&o.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{type:"button",onClick:()=>j("personal"),disabled:l==="personal",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(U,{className:"h-4 w-4"}),"Continue with personal account",l==="personal"&&e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"})]})})]})]})}export{Z as component};

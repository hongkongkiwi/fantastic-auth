import{j as e,L as p,z as h,co as f,cp as N,bX as y,cq as g,cr as w,cs as b,aa as k}from"./vendor-DTXcECKj.js";import{u as _,b as S,c as x,t as c,B as j,n as C}from"./main-D_qbY1gz.js";import"./vendor-sonner-CauEFWQC.js";import"./vendor-motion-DirI8ZVJ.js";import"./vendor-sentry-DWdptYQI.js";function $({userId:s}){const i=_(),t=!!s,{data:n,isLoading:v}=S({queryKey:["sessions",s||"me"],queryFn:async()=>{const a=t?`/api/v1/admin/users/${s}/sessions`:"/api/v1/auth/sessions",r=await fetch(a);if(!r.ok)throw new Error("Failed to load sessions");return r.json()}}),l=x({mutationFn:async a=>{const r=t?`/api/v1/admin/users/${s}/sessions/${a}`:`/api/v1/auth/sessions/${a}`;await fetch(r,{method:"DELETE"})},onSuccess:()=>{i.invalidateQueries({queryKey:["sessions",s||"me"]}),c.success("Session revoked")},onError:()=>c.error("Failed to revoke session")}),d=x({mutationFn:async()=>{const a=t?`/api/v1/admin/users/${s}/sessions/revoke-all`:"/api/v1/auth/sessions/revoke-all";await fetch(a,{method:"POST"})},onSuccess:()=>{i.invalidateQueries({queryKey:["sessions",s||"me"]}),c.success("All other sessions revoked")},onError:()=>c.error("Failed to revoke sessions")});if(v)return e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(p,{className:"h-6 w-6 animate-spin text-muted-foreground"})});const m=n?.find(a=>a.is_current),o=n?.filter(a=>!a.is_current)||[];return e.jsxs("div",{className:"space-y-6",children:[m&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Current Session"}),e.jsx(u,{session:m})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Other Sessions"}),o.length>0&&e.jsxs(j,{variant:"ghost",size:"sm",onClick:()=>d.mutate(),disabled:d.isPending,children:[e.jsx(h,{className:"mr-2 h-4 w-4"}),"Revoke All"]})]}),o.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(f,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No other active sessions"})]}):e.jsx("div",{className:"space-y-2",children:o.map(a=>e.jsx(u,{session:a,onRevoke:()=>l.mutate(a.id),isRevoking:l.isPending},a.id))})]})]})}function u({session:s,onRevoke:i,isRevoking:t}){const n={desktop:g,mobile:y,tablet:N}[s.device_info.device_type]||w;return e.jsx("div",{className:`p-4 rounded-lg border ${s.is_current?"border-primary bg-primary/5":"border-border"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-muted",children:e.jsx(n,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.device_info.name}),s.is_current&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary text-primary-foreground rounded-full",children:"Current"})]}),e.jsxs("div",{className:"mt-1 text-sm text-muted-foreground space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s.device_info.browser}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:s.device_info.os})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[s.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"h-3 w-3"}),s.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3"}),"Active ",C(new Date(s.last_active_at))]})]}),e.jsx("span",{className:"font-mono text-xs text-muted-foreground/60",children:s.ip_address})]})]})]}),!s.is_current&&i&&e.jsx(j,{variant:"ghost",size:"sm",onClick:i,disabled:t,children:t?e.jsx(p,{className:"h-4 w-4 animate-spin"}):e.jsx(h,{className:"h-4 w-4"})})]})})}export{$ as SessionManager};

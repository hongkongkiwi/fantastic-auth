import{r as i,j as e,N as P,B as k,bH as F,a7 as L,bI as M,bJ as $,bK as B,bL as E}from"./vendor-DTXcECKj.js";import{g as K,a as u,P as U,B as b,L as h,C as x,t as l,d as O,o as R}from"./main-D_qbY1gz.js";import{D as z,c as H,a as q,b as J}from"./DataTable-B1vFbS0r.js";import{C as T}from"./Card-ovhP7agJ.js";import{D as V,a as G,b as Q,c as o}from"./DropdownMenu-DLlbKs3-.js";import{c as W,s as X,e as Y,f as Z}from"./internal-api-CvC1OOUg.js";import{u as _,m as ee}from"./vendor-motion-DirI8ZVJ.js";import"./vendor-sonner-CauEFWQC.js";import"./vendor-sentry-DWdptYQI.js";import"./Input-CvXUl1_l.js";import"./logger-BML-1mmb.js";const ae={free:"secondary",starter:"info",pro:"success",enterprise:"warning"},te={active:{label:"Active",variant:"success"},suspended:{label:"Suspended",variant:"warning"},inactive:{label:"Inactive",variant:"destructive"}};function he(){const[c,y]=i.useState([]),[w,g]=i.useState(!0),[s,d]=i.useState(null),[r,n]=i.useState(null),[m,f]=i.useState(!1),v=_(),C=K(),S=u(W),N=u(X),D=u(Y),A=u(Z),j=async()=>{g(!0);try{const a=await S({data:{page:1,perPage:50}});y(a.data||[])}catch{l.error("Failed to load tenants")}finally{g(!1)}};i.useEffect(()=>{j()},[]);const p=async()=>{if(!(!s||!r)){if(!s.id){l.error("Tenant ID is missing");return}f(!0);try{switch(r){case"suspend":await N({data:{tenantId:s.id}}),l.success("Tenant suspended successfully");break;case"activate":await D({data:{tenantId:s.id}}),l.success("Tenant activated successfully");break;case"delete":await A({data:{tenantId:s.id}}),l.success("Tenant deleted successfully");break}await j()}catch{l.error(`Failed to ${r} tenant`)}finally{f(!1),n(null),d(null)}}},I=[H(),{accessorKey:"name",header:"Tenant",cell:({row:a})=>{const t=a.original;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx(k,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name??"Unnamed tenant"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.slug??"—"})]})]})}},{accessorKey:"plan",header:"Plan",cell:({getValue:a})=>{const t=String(a()??"unknown");return e.jsx(O,{variant:ae[t]||"default",children:t.charAt(0).toUpperCase()+t.slice(1)})}},{accessorKey:"status",header:"Status",cell:q(te)},{accessorKey:"usage.currentUsers",header:"Users",cell:({row:a})=>R(a.original.usage?.currentUsers??0)},{accessorKey:"createdAt",header:"Created",cell:J()},{id:"actions",header:"",cell:({row:a})=>{const t=a.original;return e.jsxs(V,{children:[e.jsx(G,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"icon-sm","aria-label":"Open tenant actions",children:e.jsx(F,{className:"h-4 w-4"})})}),e.jsxs(Q,{align:"end",children:[e.jsx(o,{asChild:!0,children:e.jsxs(h,{to:"/tenants/$id",params:{id:t.id??""},children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"View Details"]})}),e.jsx(o,{asChild:!0,children:e.jsxs(h,{to:"/tenants/$id",params:{id:t.id??""},children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Edit"]})}),t.status==="active"?e.jsxs(o,{onClick:()=>{d(t),n("suspend")},children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Suspend"]}):e.jsxs(o,{onClick:()=>{d(t),n("activate")},children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Activate"]}),e.jsxs(o,{className:"text-destructive focus:text-destructive",onClick:()=>{d(t),n("delete")},children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(U,{title:"Tenants",description:"Manage your platform tenants and their subscriptions",breadcrumbs:[{label:"Tenants"}],actions:e.jsx(b,{asChild:!0,leftIcon:e.jsx(P,{className:"h-4 w-4"}),children:e.jsx(h,{to:"/tenants/create",children:"Create Tenant"})})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Tenants",value:c.length,color:"blue"},{label:"Active",value:c.filter(a=>a.status==="active").length,color:"green"},{label:"Suspended",value:c.filter(a=>a.status==="suspended").length,color:"amber"},{label:"Enterprise",value:c.filter(a=>a.plan==="enterprise").length,color:"purple"}].map((a,t)=>e.jsx(ee.div,{initial:v?!1:{opacity:0,y:20},animate:{opacity:1,y:0},transition:v?{duration:0}:{delay:t*.1},children:e.jsxs(T,{className:"p-6 card-hover",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:a.label}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:a.value})]})},a.label))}),e.jsx(T,{children:e.jsx(z,{columns:I,data:c,isLoading:w,searchable:!0,searchPlaceholder:"Search tenants by name or slug…",pagination:!0,pageSize:10,onRowClick:a=>{C({to:`/tenants/${a.id}`})},exportable:!0,exportFileName:"tenants"})}),e.jsx(x,{isOpen:r==="suspend",onClose:()=>n(null),onConfirm:p,title:"Suspend Tenant",description:`Are you sure you want to suspend "${s?.name}"? This will prevent users from accessing the tenant.`,confirmText:"Suspend",variant:"destructive",isLoading:m}),e.jsx(x,{isOpen:r==="activate",onClose:()=>n(null),onConfirm:p,title:"Activate Tenant",description:`Are you sure you want to activate "${s?.name}"?`,confirmText:"Activate",isLoading:m}),e.jsx(x,{isOpen:r==="delete",onClose:()=>n(null),onConfirm:p,title:"Delete Tenant",description:`Are you sure you want to delete "${s?.name}"? This action cannot be undone.`,confirmText:"Delete",variant:"destructive",isLoading:m})]})}export{he as component};

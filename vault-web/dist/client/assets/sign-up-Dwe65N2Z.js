import{j as t,_ as P,G as U,b as c,m as C,J as T,Z as A,ai as I}from"./main-BdAAzOp_.js";import{I as h}from"./Input-DmXcK8Ek.js";import{C as w,d as y,a as E,b as L,c as B}from"./Card-BgwA5byp.js";import{A as _,a as F}from"./Alert-DT3fX0Ix.js";import{C as H}from"./Checkbox-C1KPPGQi.js";import{u as q}from"./useForm-D0kRy4nt.js";import{u as O,H as D,a as R,b as M,c as V}from"./HostedLayout-C9ABfqpe.js";import{S as z,E as G,a as W}from"./SocialLoginButtons-DuK6ZazW.js";import{C as J}from"./circle-check-big-BtZ3JG_-.js";import{C as Z}from"./circle-alert-DITzmtt1.js";import{U as $}from"./user-CSbn4zdS.js";import{M as Y}from"./mail-nvpjyHZd.js";import{L as K}from"./lock-PhA2rBqp.js";import"./index-CoX5m-mX.js";import"./index-DBCmHaCG.js";import"./check-OH4VeEnu.js";function ge(){const p=O();return t.jsx(D,{searchParams:new URLSearchParams(window.location.search),children:t.jsx(Q,{searchParams:p})})}function Q({searchParams:p}){const g=P(),{config:a,tenantId:s,redirectUrl:d}=R(),x=U(),[u,N]=c.useState(!1),[i,f]=c.useState(!1),[v,m]=c.useState(null),[b,j]=c.useState(null),[S,k]=c.useState(!1),o=q({defaultValues:{name:"",email:"",password:"",agreeToTerms:!1},onSubmit:async({value:e})=>{if(s){f(!0),m(null);try{const r=await M({data:{name:e.name,email:e.email,password:e.password,tenantId:s,redirectUrl:d||void 0}});a?.requireEmailVerification?k(!0):window.location.href=r.redirectUrl}catch(r){m(r instanceof Error?r.message:"Sign up failed")}finally{f(!1)}}}}),l=async e=>{if(s){j(e),m(null);try{const r=await V({data:{provider:e,tenantId:s,redirectUrl:d||void 0}});sessionStorage.setItem("hosted_oauth_state",r.state),window.location.href=r.authUrl}catch(r){m(r instanceof Error?r.message:"OAuth failed"),j(null)}}};if(!a||!s)return null;if(!a.allowSignUp)return g({to:"/hosted/sign-in",search:{tenant_id:s,redirect_url:d||void 0}}),null;const n=a.oauthProviders.filter(e=>["google","github","apple","slack","discord"].includes(e));return S?t.jsx(w,{className:"shadow-elevated",children:t.jsx(y,{className:"pt-6",children:t.jsxs("div",{className:"text-center space-y-4 py-8",children:[t.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto",children:t.jsx(J,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold",children:"Verify your email"}),t.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["We've sent a verification link to ",t.jsx("strong",{children:o.getFieldValue("email")})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Click the link in your email to complete your registration."})]}),t.jsx(C,{variant:"outline",fullWidth:!0,onClick:()=>g({to:"/hosted/sign-in",search:{tenant_id:s}}),children:"Back to Sign In"})]})})}):t.jsxs(w,{className:"shadow-elevated",children:[t.jsxs(E,{className:"space-y-1",children:[t.jsx(L,{className:"text-2xl text-center",children:a.signUpTitle||`Create your ${a.companyName} account`}),t.jsx(B,{className:"text-center",children:"Enter your details to get started"})]}),t.jsxs(y,{className:"space-y-4",children:[v&&t.jsxs(_,{variant:"destructive",children:[t.jsx(Z,{className:"h-4 w-4"}),t.jsx(F,{children:v})]}),n.length>0&&t.jsx(T.div,{initial:x?!1:{opacity:0},animate:{opacity:1},transition:x?{duration:0}:{delay:.1},children:t.jsx(z,{onGoogleClick:n.includes("google")?()=>l("google"):void 0,onGitHubClick:n.includes("github")?()=>l("github"):void 0,onAppleClick:n.includes("apple")?()=>l("apple"):void 0,onSlackClick:n.includes("slack")?()=>l("slack"):void 0,onDiscordClick:n.includes("discord")?()=>l("discord"):void 0,isLoading:!!b})}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),o.handleSubmit()},className:"space-y-4",children:[t.jsx(o.Field,{name:"name",validators:{onChange:({value:e})=>{if(!e.trim())return"Name is required";if(e.trim().length<2)return"Name must be at least 2 characters"}},children:e=>t.jsx(h,{label:"Full Name",type:"text",placeholder:"John Doe",value:e.state.value,onChange:r=>e.handleChange(r.target.value),onBlur:e.handleBlur,error:e.state.meta.isTouched?e.state.meta.errors[0]:void 0,leftIcon:t.jsx($,{className:"h-4 w-4 text-muted-foreground"}),autoComplete:"name",required:!0,disabled:i})}),t.jsx(o.Field,{name:"email",validators:{onChange:({value:e})=>{if(!e.trim())return"Email is required";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return"Please enter a valid email"}},children:e=>t.jsx(h,{label:"Email",type:"email",placeholder:"you@example.com",value:e.state.value,onChange:r=>e.handleChange(r.target.value),onBlur:e.handleBlur,error:e.state.meta.isTouched?e.state.meta.errors[0]:void 0,leftIcon:t.jsx(Y,{className:"h-4 w-4 text-muted-foreground"}),autoComplete:"email",autoCapitalize:"none",spellCheck:!1,required:!0,disabled:i})}),t.jsx(o.Field,{name:"password",validators:{onChange:({value:e})=>{if(!e)return"Password is required";if(e.length<8)return"Password must be at least 8 characters";if(!/[A-Z]/.test(e))return"Password must contain an uppercase letter";if(!/[a-z]/.test(e))return"Password must contain a lowercase letter";if(!/[0-9]/.test(e))return"Password must contain a number"}},children:e=>t.jsx(h,{label:"Password",type:u?"text":"password",placeholder:"••••••••",value:e.state.value,onChange:r=>e.handleChange(r.target.value),onBlur:e.handleBlur,error:e.state.meta.isTouched?e.state.meta.errors[0]:void 0,leftIcon:t.jsx(K,{className:"h-4 w-4 text-muted-foreground"}),autoComplete:"new-password",rightIcon:t.jsx("button",{type:"button",onClick:()=>N(!u),className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":u?"Hide password":"Show password",children:u?t.jsx(G,{className:"h-4 w-4"}):t.jsx(W,{className:"h-4 w-4"})}),required:!0,disabled:i})}),(a.termsUrl||a.privacyUrl)&&t.jsx(o.Field,{name:"agreeToTerms",validators:{onChange:({value:e})=>{if(!e)return"You must agree to continue"}},children:e=>t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(H,{id:"agreeToTerms",checked:e.state.value,onCheckedChange:r=>e.handleChange(r),disabled:i}),t.jsxs("label",{htmlFor:"agreeToTerms",className:"text-sm text-muted-foreground leading-relaxed cursor-pointer",children:["I agree to the"," ",a.termsUrl?t.jsx("a",{href:a.termsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",onClick:r=>r.stopPropagation(),children:"Terms of Service"}):"Terms of Service",a.termsUrl&&a.privacyUrl&&" and ",a.privacyUrl?t.jsx("a",{href:a.privacyUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",onClick:r=>r.stopPropagation(),children:"Privacy Policy"}):a.termsUrl?"Privacy Policy":null]})]}),e.state.meta.isTouched&&e.state.meta.errors[0]&&t.jsx("p",{className:"text-sm text-destructive",children:e.state.meta.errors[0]})]})}),t.jsx(C,{type:"submit",fullWidth:!0,size:"lg",isLoading:i,rightIcon:t.jsx(A,{className:"h-4 w-4"}),children:"Create Account"})]}),t.jsxs("div",{className:"text-center text-sm pt-4 border-t",children:[t.jsxs("span",{className:"text-muted-foreground",children:["Already have an account?"," "]}),t.jsx(I,{to:"/hosted/sign-in",search:{tenant_id:s,redirect_url:d||void 0},className:"text-primary hover:underline",children:"Sign in"})]})]})]})}export{ge as component};

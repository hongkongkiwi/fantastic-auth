import{b as l,j as e,C as x,G as F,H as S,a0 as I,a1 as R,I as E,m as T,a2 as w,J as B,L as y,a3 as M,a4 as $,S as D,M as K,B as O}from"./main-BdAAzOp_.js";import{C as P,D as H}from"./DataTable-DZ4Ke5vQ.js";import{B as W}from"./Badge-C3IvCy62.js";import{C,a as G,b as q,d as z}from"./Card-BgwA5byp.js";import{I as L}from"./Input-DmXcK8Ek.js";import{D as J}from"./download-B8kCLmm8.js";import{C as V}from"./calendar-CUi8vfho.js";import{C as A}from"./circle-alert-DITzmtt1.js";import{U as Q}from"./user-CSbn4zdS.js";import{C as X}from"./circle-check-BGQIKgJL.js";import"./Skeleton-ChEia7iB.js";import"./Checkbox-C1KPPGQi.js";import"./index-CoX5m-mX.js";import"./index-DBCmHaCG.js";import"./check-OH4VeEnu.js";import"./DropdownMenu-DQ1y4H24.js";import"./index-5WLq0AmM.js";import"./index-TAemdWJe.js";const U=l.forwardRef(({className:b,options:j,label:h,error:d,helperText:i,placeholder:c,onChange:s,fullWidth:u,id:p,...g},N)=>{const r=p||l.useId(),o=!!d;return e.jsxs("div",{className:x("space-y-1.5",u&&"w-full"),children:[h&&e.jsxs("label",{htmlFor:r,className:"text-sm font-medium text-foreground",children:[h,g.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:r,className:x("flex h-10 w-full appearance-none rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background transition-colors transition-shadow duration-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50","hover:border-muted-foreground/30",o&&"border-destructive focus-visible:ring-destructive",b),ref:N,onChange:n=>s?.(n.target.value),"aria-invalid":o,"aria-describedby":o?`${r}-error`:void 0,...g,children:[c&&e.jsx("option",{value:"",disabled:!0,children:c}),j.map(n=>e.jsx("option",{value:n.value,disabled:n.disabled,children:n.label},n.value))]}),e.jsx(P,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground pointer-events-none","aria-hidden":"true"})]}),o?e.jsx("p",{id:`${r}-error`,className:"text-sm text-destructive animate-fade-in",children:d}):i?e.jsx("p",{className:"text-sm text-muted-foreground",children:i}):null]})});U.displayName="Select";const Y={"tenant.create":e.jsx(O,{className:"h-4 w-4","aria-hidden":"true"}),"tenant.update":e.jsx(K,{className:"h-4 w-4","aria-hidden":"true"}),"tenant.suspend":e.jsx(A,{className:"h-4 w-4","aria-hidden":"true"}),"tenant.activate":e.jsx(X,{className:"h-4 w-4","aria-hidden":"true"}),"tenant.delete":e.jsx(A,{className:"h-4 w-4","aria-hidden":"true"}),"user.create":e.jsx(Q,{className:"h-4 w-4","aria-hidden":"true"}),"auth.login":e.jsx(D,{className:"h-4 w-4","aria-hidden":"true"}),"auth.logout":e.jsx(D,{className:"h-4 w-4","aria-hidden":"true"})},Z={"tenant.create":"bg-blue-500/10 text-blue-600","tenant.update":"bg-slate-500/10 text-slate-600","tenant.suspend":"bg-amber-500/10 text-amber-600","tenant.activate":"bg-green-500/10 text-green-600","tenant.delete":"bg-red-500/10 text-red-600","user.create":"bg-purple-500/10 text-purple-600","auth.login":"bg-emerald-500/10 text-emerald-600","auth.logout":"bg-gray-500/10 text-gray-600"},_={"tenant.create":"Tenant Created","tenant.update":"Tenant Updated","tenant.suspend":"Tenant Suspended","tenant.activate":"Tenant Activated","tenant.delete":"Tenant Deleted","tenant.migrate":"Tenant Migrated","user.create":"User Created","user.update":"User Updated","user.delete":"User Deleted","auth.login":"Login","auth.logout":"Logout","auth.expired":"Session Expired","subscription.update":"Subscription Updated","invoice.generate":"Invoice Generated"},ee=[{value:"",label:"All Actions"},{value:"tenant",label:"Tenant Actions"},{value:"user",label:"User Actions"},{value:"auth",label:"Authentication"},{value:"subscription",label:"Billing"}];function be(){const[b,j]=l.useState([]),[h,d]=l.useState(!0),[i,c]=l.useState(""),[s,u]=l.useState({since:"",until:""}),p=F(),g=S(I),N=S(R),r=async(t=1)=>{d(!0);try{const a=await g({data:{action:i||void 0,since:s.since||void 0,until:s.until||void 0,page:t,perPage:50,sort:"desc"}});j(a.data||[])}catch{y.error("Failed to load audit logs")}finally{d(!1)}};l.useEffect(()=>{r()},[i,s]);const o=async()=>{try{const t=await N({data:{action:i||void 0,since:s.since||void 0,until:s.until||void 0}}),a=new Blob([t],{type:"text/csv"}),f=URL.createObjectURL(a),m=document.createElement("a");m.href=f,m.download=`audit-log-${new Date().toISOString().split("T")[0]}.csv`,m.click(),URL.revokeObjectURL(f),y.success("Audit log downloaded")}catch{y.error("Failed to download audit log")}},n=[{accessorKey:"timestamp",header:"Time",cell:({getValue:t})=>{const a=t();return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:M(a)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:$(a)})]})}},{accessorKey:"action",header:"Action",cell:({getValue:t})=>{const a=t(),f=Y[a]||e.jsx(w,{className:"h-4 w-4","aria-hidden":"true"}),m=Z[a]||"bg-gray-500/10 text-gray-600",k=_[a]||a;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:x("p-2 rounded-full",m),children:f}),e.jsx("span",{className:"font-medium",children:k})]})}},{accessorKey:"detail",header:"Details",cell:({getValue:t})=>e.jsx("p",{className:"text-sm text-muted-foreground max-w-md truncate",children:t()})},{accessorKey:"source",header:"Source",cell:({getValue:t})=>{const a=t();return e.jsx(W,{variant:a==="ui"?"default":"secondary",children:a?.toUpperCase()||"API"})}}],v={today:245,thisWeek:1847,thisMonth:8934,failed:12};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(E,{title:"Audit Logs",description:"Track all administrative actions across the platform",breadcrumbs:[{label:"Audit Logs"}],actions:e.jsx(T,{variant:"outline",leftIcon:e.jsx(J,{className:"h-4 w-4"}),onClick:o,children:"Export CSV"})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Today",value:v.today,icon:V,color:"blue"},{label:"This Week",value:v.thisWeek,icon:w,color:"green"},{label:"This Month",value:v.thisMonth,icon:w,color:"purple"},{label:"Failed Actions",value:v.failed,icon:A,color:"rose"}].map((t,a)=>e.jsx(B.div,{initial:p?!1:{opacity:0,y:20},animate:{opacity:1,y:0},transition:p?{duration:0}:{delay:a*.1},children:e.jsx(C,{className:"p-6 card-hover",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t.label}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:t.value.toLocaleString()})]}),e.jsx("div",{className:x("p-3 rounded-lg",`bg-${t.color}-500/10`),children:e.jsx(t.icon,{className:x("h-5 w-5",`text-${t.color}-600`)})})]})})},t.label))}),e.jsxs(C,{children:[e.jsx(G,{children:e.jsx(q,{className:"text-base",children:"Filters"})}),e.jsx(z,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"w-full sm:w-64",children:e.jsx(U,{label:"Action Type",options:ee,value:i,onChange:t=>c(t),name:"actionFilter",autoComplete:"off"})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsx(L,{label:"From",type:"date",value:s.since,onChange:t=>u({...s,since:t.target.value}),name:"sinceDate",autoComplete:"off"})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsx(L,{label:"To",type:"date",value:s.until,onChange:t=>u({...s,until:t.target.value}),name:"untilDate",autoComplete:"off"})}),e.jsx("div",{className:"flex items-end",children:e.jsx(T,{variant:"outline",onClick:()=>{c(""),u({since:"",until:""})},children:"Clear Filters"})})]})})]}),e.jsx(C,{children:e.jsx(H,{columns:n,data:b,isLoading:h,pagination:!0,pageSize:50,exportable:!1})})]})}export{be as component};

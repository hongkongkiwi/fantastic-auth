import{c as I,b as i,G as F,_ as P,H as u,ae as M,af as L,ag as E,ah as $,j as e,I as B,m as T,ai as h,aj as K,J as U,ak as x,L as l,B as O,K as R}from"./main-BdAAzOp_.js";import{D as z,c as H,b as _,d as q}from"./DataTable-DZ4Ke5vQ.js";import{B as G}from"./Badge-C3IvCy62.js";import{C as y}from"./Card-BgwA5byp.js";import{D as J,b as V,E as Q,d as W,e as o}from"./DropdownMenu-DQ1y4H24.js";import{F as X}from"./file-text-DuD-X2Op.js";import{P as Y,a as Z}from"./play-Bdy_HVjp.js";import{T as ee}from"./trash-2-BL6sv700.js";import"./Input-DmXcK8Ek.js";import"./Skeleton-ChEia7iB.js";import"./Checkbox-C1KPPGQi.js";import"./index-CoX5m-mX.js";import"./index-DBCmHaCG.js";import"./check-OH4VeEnu.js";import"./download-B8kCLmm8.js";import"./index-5WLq0AmM.js";import"./index-TAemdWJe.js";const ae=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],te=I("square-pen",ae),se={free:"secondary",starter:"info",pro:"success",enterprise:"warning"},ne={active:{label:"Active",variant:"success"},suspended:{label:"Suspended",variant:"warning"},inactive:{label:"Inactive",variant:"destructive"}};function be(){const[c,b]=i.useState([]),[w,g]=i.useState(!0),[s,d]=i.useState(null),[r,n]=i.useState(null),[m,f]=i.useState(!1),v=F(),C=P(),S=u(M),N=u(L),D=u(E),k=u($),j=async()=>{g(!0);try{const a=await S({data:{page:1,perPage:50}});b(a.data||[])}catch{l.error("Failed to load tenants")}finally{g(!1)}};i.useEffect(()=>{j()},[]);const p=async()=>{if(!(!s||!r)){if(!s.id){l.error("Tenant ID is missing");return}f(!0);try{switch(r){case"suspend":await N({data:{tenantId:s.id}}),l.success("Tenant suspended successfully");break;case"activate":await D({data:{tenantId:s.id}}),l.success("Tenant activated successfully");break;case"delete":await k({data:{tenantId:s.id}}),l.success("Tenant deleted successfully");break}await j()}catch{l.error(`Failed to ${r} tenant`)}finally{f(!1),n(null),d(null)}}},A=[H(),{accessorKey:"name",header:"Tenant",cell:({row:a})=>{const t=a.original;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx(O,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name??"Unnamed tenant"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.slug??"—"})]})]})}},{accessorKey:"plan",header:"Plan",cell:({getValue:a})=>{const t=String(a()??"unknown");return e.jsx(G,{variant:se[t]||"default",children:t.charAt(0).toUpperCase()+t.slice(1)})}},{accessorKey:"status",header:"Status",cell:_(ne)},{accessorKey:"usage.currentUsers",header:"Users",cell:({row:a})=>R(a.original.usage?.currentUsers??0)},{accessorKey:"createdAt",header:"Created",cell:q()},{id:"actions",header:"",cell:({row:a})=>{const t=a.original;return e.jsxs(J,{children:[e.jsx(V,{asChild:!0,children:e.jsx(T,{variant:"ghost",size:"icon-sm","aria-label":"Open tenant actions",children:e.jsx(Q,{className:"h-4 w-4"})})}),e.jsxs(W,{align:"end",children:[e.jsx(o,{asChild:!0,children:e.jsxs(h,{to:"/tenants/$id",params:{id:t.id??""},children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"View Details"]})}),e.jsx(o,{asChild:!0,children:e.jsxs(h,{to:"/tenants/$id",params:{id:t.id??""},children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Edit"]})}),t.status==="active"?e.jsxs(o,{onClick:()=>{d(t),n("suspend")},children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Suspend"]}):e.jsxs(o,{onClick:()=>{d(t),n("activate")},children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Activate"]}),e.jsxs(o,{className:"text-destructive focus:text-destructive",onClick:()=>{d(t),n("delete")},children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(B,{title:"Tenants",description:"Manage your platform tenants and their subscriptions",breadcrumbs:[{label:"Tenants"}],actions:e.jsx(T,{asChild:!0,leftIcon:e.jsx(K,{className:"h-4 w-4"}),children:e.jsx(h,{to:"/tenants/create",children:"Create Tenant"})})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Tenants",value:c.length,color:"blue"},{label:"Active",value:c.filter(a=>a.status==="active").length,color:"green"},{label:"Suspended",value:c.filter(a=>a.status==="suspended").length,color:"amber"},{label:"Enterprise",value:c.filter(a=>a.plan==="enterprise").length,color:"purple"}].map((a,t)=>e.jsx(U.div,{initial:v?!1:{opacity:0,y:20},animate:{opacity:1,y:0},transition:v?{duration:0}:{delay:t*.1},children:e.jsxs(y,{className:"p-6 card-hover",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:a.label}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:a.value})]})},a.label))}),e.jsx(y,{children:e.jsx(z,{columns:A,data:c,isLoading:w,searchable:!0,searchPlaceholder:"Search tenants by name or slug…",pagination:!0,pageSize:10,onRowClick:a=>{C({to:`/tenants/${a.id}`})},exportable:!0,exportFileName:"tenants"})}),e.jsx(x,{isOpen:r==="suspend",onClose:()=>n(null),onConfirm:p,title:"Suspend Tenant",description:`Are you sure you want to suspend "${s?.name}"? This will prevent users from accessing the tenant.`,confirmText:"Suspend",variant:"destructive",isLoading:m}),e.jsx(x,{isOpen:r==="activate",onClose:()=>n(null),onConfirm:p,title:"Activate Tenant",description:`Are you sure you want to activate "${s?.name}"?`,confirmText:"Activate",isLoading:m}),e.jsx(x,{isOpen:r==="delete",onClose:()=>n(null),onConfirm:p,title:"Delete Tenant",description:`Are you sure you want to delete "${s?.name}"? This action cannot be undone.`,confirmText:"Delete",variant:"destructive",isLoading:m})]})}export{be as component};

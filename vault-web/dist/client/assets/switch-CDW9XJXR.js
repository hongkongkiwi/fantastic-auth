import{c as k,j as e,_ as O,G as L,b as i,B as m,J as y,m as v,aj as b,V as P,Z as H,a7 as I}from"./main-BdAAzOp_.js";import{C as _,a as A,b as E,c as U,d as R}from"./Card-BgwA5byp.js";import{A as M,a as T}from"./Alert-DT3fX0Ix.js";import{u as B,H as D,a as F,j as Y,k as G}from"./HostedLayout-C9ABfqpe.js";import{C as J}from"./circle-alert-DITzmtt1.js";import{C as V}from"./check-OH4VeEnu.js";const W=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Z=k("crown",W);function ae(){const h=B();return e.jsx(D,{searchParams:new URLSearchParams(window.location.search),children:e.jsx($,{searchParams:h})})}function $({searchParams:h}){const C=O(),{config:z,tenantId:r,redirectUrl:x,organizationId:u}=F(),l=L(),[d,p]=i.useState(!0),[g,n]=i.useState(null),[o,S]=i.useState([]),[c,f]=i.useState(null),j=()=>sessionStorage.getItem("hosted_session_token")||"";if(i.useEffect(()=>{if(!r)return;(async()=>{const t=j();if(!t){n("You must be signed in to view organizations"),p(!1);return}try{const a=await Y({data:{tenantId:r,sessionToken:t}});S(a.organizations)}catch(a){n(a instanceof Error?a.message:"Failed to load organizations")}finally{p(!1)}})()},[r]),!z||!r)return null;const N=async s=>{const t=j();if(!t){n("Session expired. Please sign in again.");return}f(s),n(null);try{const a=await G({data:{organizationId:s,tenantId:r,sessionToken:t}});window.location.href=x||a.redirectUrl}catch(a){n(a instanceof Error?a.message:"Failed to switch organization"),f(null)}},w=()=>{C({to:"/hosted/organization/create",search:{tenant_id:r,redirect_url:x||void 0}})};return e.jsxs(_,{className:"shadow-elevated",children:[e.jsxs(A,{className:"space-y-1",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:e.jsx(m,{className:"h-6 w-6 text-primary"})}),e.jsx(E,{className:"text-2xl text-center",children:"Switch Organization"}),e.jsx(U,{className:"text-center",children:"Select an organization to continue"})]}),e.jsxs(R,{className:"space-y-4",children:[g&&e.jsxs(M,{variant:"destructive",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx(T,{children:g})]}),d?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading organizations..."})]}):o.length===0?e.jsxs(y.div,{initial:l?!1:{opacity:0},animate:{opacity:1},className:"text-center py-8 space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto",children:e.jsx(m,{className:"h-8 w-8 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"You don't have any organizations yet."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create one to get started."})]}),e.jsxs(v,{onClick:w,className:"gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"Create Organization"]})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(P,{mode:"popLayout",children:o.map((s,t)=>e.jsx(y.div,{initial:l?!1:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},transition:{delay:l?0:t*.05},children:e.jsxs("button",{onClick:()=>N(s.id),disabled:c===s.id,className:`w-full flex items-center gap-4 p-4 rounded-lg border transition-all text-left ${u===s.id?"border-primary bg-primary/5":"border-border hover:border-primary/50 hover:bg-muted/50"}`,children:[e.jsx("div",{className:"flex-shrink-0",children:s.logoUrl?e.jsx("img",{src:s.logoUrl,alt:s.name,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx(m,{className:"h-6 w-6 text-primary"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold truncate",children:s.name}),s.role==="owner"&&e.jsx(Z,{className:"h-4 w-4 text-amber-500 flex-shrink-0",title:"Owner"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["/",s.slug]})]}),e.jsx("div",{className:"flex-shrink-0",children:c===s.id?e.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}):u===s.id?e.jsxs("div",{className:"flex items-center gap-1 text-primary text-sm",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Current"})]}):e.jsx(H,{className:"h-5 w-5 text-muted-foreground"})})]})},s.id))})}),!d&&o.length>0&&e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(v,{variant:"outline",fullWidth:!0,onClick:w,className:"gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"Create New Organization"]})}),!d&&o.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:()=>N("personal"),disabled:c==="personal",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(I,{className:"h-4 w-4"}),"Continue with personal account",c==="personal"&&e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"})]})})]})]})}export{ae as component};

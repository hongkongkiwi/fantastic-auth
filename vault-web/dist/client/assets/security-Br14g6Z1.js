const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MfaEnroll-BWvNi8BF.js","assets/main-BdAAzOp_.js","assets/Input-DmXcK8Ek.js","assets/smartphone-Dki1OkCf.js","assets/mail-nvpjyHZd.js","assets/check-OH4VeEnu.js","assets/download-B8kCLmm8.js","assets/SessionManager-C-NQ36ep.js","assets/useQuery-ButOQx42.js","assets/useMutation-BBfU30nI.js"])))=>i.map(i=>d[i]);
import{b as t,j as e,I as P,S as o,U as S,J as T,m as r,D as A,f as E,h as M,i as _,k,a9 as v}from"./main-BdAAzOp_.js";import{C as c}from"./Card-BgwA5byp.js";import{B as j}from"./Badge-C3IvCy62.js";import{T as D,a as B,b as u,c as h}from"./Tabs-c8LIGITi.js";import{a as g}from"./Skeleton-ChEia7iB.js";import{I as x}from"./Input-DmXcK8Ek.js";import{u as F}from"./useForm-D0kRy4nt.js";import{M as w}from"./mail-nvpjyHZd.js";import{S as N}from"./smartphone-Dki1OkCf.js";import{C as O}from"./circle-check-big-BtZ3JG_-.js";import{T as I}from"./trash-2-BL6sv700.js";import{C as L}from"./circle-alert-DITzmtt1.js";import"./index-TAemdWJe.js";import"./index-5WLq0AmM.js";const U=t.lazy(()=>v(()=>import("./MfaEnroll-BWvNi8BF.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(l=>({default:l.MfaEnroll}))),R=t.lazy(()=>v(()=>import("./SessionManager-C-NQ36ep.js"),__vite__mapDeps([7,1,8,9,3])).then(l=>({default:l.SessionManager})));function se(){const[l,f]=t.useState("mfa"),[y,n]=t.useState(!1),[d,m]=t.useState("totp"),[b,p]=t.useState(!1),i=F({defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""},onSubmit:async()=>{p(!0);try{await new Promise(s=>setTimeout(s,500))}finally{p(!1)}}}),C=[{type:"totp",name:"Authenticator App",enabled:!0,created_at:"2024-01-15"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(P,{title:"Security Settings",description:"Manage your account security and authentication methods",breadcrumbs:[{label:"Settings",href:"/settings"},{label:"Security"}]}),e.jsxs(D,{value:l,onValueChange:f,children:[e.jsxs(B,{className:"grid w-full grid-cols-3 lg:w-auto",children:[e.jsxs(u,{value:"mfa",className:"gap-2",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"MFA"})]}),e.jsxs(u,{value:"sessions",className:"gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Sessions"})]}),e.jsxs(u,{value:"password",className:"gap-2",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Password"})]})]}),e.jsxs(h,{value:"mfa",className:"space-y-6",children:[e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Multi-Factor Authentication"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Add an extra layer of security to your account"})]}),e.jsx(j,{variant:"success",children:"Enabled"})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[C.map(s=>e.jsxs(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"p-2 bg-primary/10 rounded-lg",children:[s.type==="totp"&&e.jsx(o,{className:"h-5 w-5 text-primary"}),s.type==="email"&&e.jsx(w,{className:"h-5 w-5 text-primary"}),s.type==="sms"&&e.jsx(N,{className:"h-5 w-5 text-primary"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Added ",new Date(s.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(j,{variant:"success",className:"gap-1",children:[e.jsx(O,{className:"h-3 w-3"}),"Active"]}),e.jsx(r,{variant:"ghost",size:"icon","aria-label":"Remove MFA method",children:e.jsx(I,{className:"h-4 w-4 text-destructive"})})]})]},s.type)),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mt-4",children:[e.jsxs(r,{variant:"outline",className:"h-auto py-4 flex-col items-center gap-2",onClick:()=>{m("totp"),n(!0)},children:[e.jsx(o,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Authenticator App"})]}),e.jsxs(r,{variant:"outline",className:"h-auto py-4 flex-col items-center gap-2",onClick:()=>{m("email"),n(!0)},children:[e.jsx(w,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Email OTP"})]}),e.jsxs(r,{variant:"outline",className:"h-auto py-4 flex-col items-center gap-2",onClick:()=>{m("sms"),n(!0)},children:[e.jsx(N,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"SMS OTP"})]})]})]})]}),e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/20 rounded-lg",children:e.jsx(L,{className:"h-6 w-6 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Backup Codes"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Generate backup codes to access your account if you lose your MFA device"}),e.jsx(r,{variant:"outline",className:"mt-4",children:"Generate New Codes"})]})]})})]}),e.jsx(h,{value:"sessions",children:e.jsx(c,{className:"p-6",children:e.jsx(t.Suspense,{fallback:e.jsx(g,{className:"h-64 w-full"}),children:e.jsx(R,{})})})}),e.jsx(h,{value:"password",children:e.jsxs(c,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Change Password"}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),i.handleSubmit()},className:"space-y-4 max-w-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Current Password"}),e.jsx(i.Field,{name:"currentPassword",validators:{onChange:({value:s})=>{if(!s)return"Current password is required"}},children:s=>e.jsx(x,{type:"password",placeholder:"Enter current password",value:s.state.value,onChange:a=>s.handleChange(a.target.value),onBlur:s.handleBlur,error:s.state.meta.isTouched?s.state.meta.errors[0]:void 0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"New Password"}),e.jsx(i.Field,{name:"newPassword",validators:{onChange:({value:s})=>{if(!s)return"New password is required";if(s.length<8)return"Password must be at least 8 characters"}},children:s=>e.jsx(x,{type:"password",placeholder:"Enter new password",value:s.state.value,onChange:a=>s.handleChange(a.target.value),onBlur:s.handleBlur,error:s.state.meta.isTouched?s.state.meta.errors[0]:void 0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Confirm New Password"}),e.jsx(i.Field,{name:"confirmPassword",validators:{onChange:({value:s})=>{if(!s)return"Please confirm your new password"}},children:s=>e.jsx(x,{type:"password",placeholder:"Confirm new password",value:s.state.value,onChange:a=>s.handleChange(a.target.value),onBlur:s.handleBlur,error:s.state.meta.isTouched?s.state.meta.errors[0]:void 0})}),e.jsx(i.Subscribe,{selector:s=>({newPassword:s.values.newPassword,confirmPassword:s.values.confirmPassword}),children:({newPassword:s,confirmPassword:a})=>a&&s&&a!==s?e.jsx("p",{className:"text-sm text-destructive",children:"Passwords do not match"}):null})]}),e.jsx(r,{type:"submit",isLoading:b,children:"Update Password"})]})]})})]}),e.jsx(A,{open:y,onOpenChange:n,children:e.jsxs(E,{className:"max-w-md",children:[e.jsxs(M,{children:[e.jsxs(_,{children:["Set Up ",d==="totp"?"Authenticator App":d==="email"?"Email OTP":"SMS OTP"]}),e.jsx(k,{children:"Add an extra layer of security to your account"})]}),e.jsx(t.Suspense,{fallback:e.jsx(g,{className:"h-72 w-full"}),children:e.jsx(U,{method:d,onEnroll:async s=>{await new Promise(a=>setTimeout(a,1e3))},onCancel:()=>n(!1)})})]})})]})}export{se as component};
